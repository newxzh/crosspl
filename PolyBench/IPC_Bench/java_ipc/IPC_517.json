{
  "Task_id": 517,
  "Github_ID": "20668562",
  "Github_Project_Name": "UltimateAndroid",
  "Programming_Language": "Java",
  "suffix": ".java",
  "Interface_class": "IPC",
  "Interface_name": "java.net ServerSocket",
  "Instruction": "Task Description: Create a TCP server class that listens for incoming client connections, processes client requests, and sends responses back using a thread pool for handling multiple concurrent connections.\n\nClass Description: The ViewServer class implements a TCP server that listens on a specified port, accepts client connections, and handles each connection in a separate worker thread using a fixed-size thread pool. The server can send data to connected clients and process incoming requests.\n\nAttributes:\n- mServer: ServerSocket - The server socket that listens for incoming connections  \n- mPort: int - The port number on which the server listens  \n- mThread: Thread - The thread in which the server runs  \n- mThreadPool: ExecutorService - The thread pool for handling client connections  \n\nMethods:\n- start() -> boolean - Starts the server thread and initializes the thread pool. Returns true if successful, false if already running  \n- run() - The main server loop that accepts incoming connections and delegates them to worker threads  \n- writeValue(Socket client, String value) -> boolean - Writes a string value to the specified client socket. Returns true if successful, false otherwise  \n- ViewServerWorker(Socket client) - Constructor for the inner worker class that handles individual client connections  \n- ViewServerWorker.run() - Processes an individual client connection, reading requests and sending responses  \n\nInner Class:\nViewServerWorker - Handles individual client connections with these methods:\n- run() - Reads client input, processes the request, and manages connection cleanup",
  "Canonical_solution": "import java.io.BufferedReader;\nimport java.io.BufferedWriter;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.io.OutputStream;\nimport java.io.OutputStreamWriter;\nimport java.net.InetAddress;\nimport java.net.ServerSocket;\nimport java.net.Socket;\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\n\npublic class ViewServer implements Runnable {\n    private static final int VIEW_SERVER_DEFAULT_PORT = 4939;\n    private static final int VIEW_SERVER_MAX_CONNECTIONS = 10;\n    \n    private ServerSocket mServer;\n    private final int mPort;\n    private Thread mThread;\n    private ExecutorService mThreadPool;\n\n    private ViewServer(int port) {\n        mPort = port;\n    }\n\n    public boolean start() throws IOException {\n        if (mThread != null) {\n            return false;\n        }\n\n        mThread = new Thread(this, \"Local View Server [port=\" + mPort + \"]\");\n        mThreadPool = Executors.newFixedThreadPool(VIEW_SERVER_MAX_CONNECTIONS);\n        mThread.start();\n\n        return true;\n    }\n\n    public void run() {\n        try {\n            mServer = new ServerSocket(mPort, VIEW_SERVER_MAX_CONNECTIONS, InetAddress.getLocalHost());\n        } catch (Exception e) {\n            Log.w(LOG_TAG, \"Starting ServerSocket error: \", e);\n        }\n\n        while (mServer != null && Thread.currentThread() == mThread) {\n            try {\n                Socket client = mServer.accept();\n                if (mThreadPool != null) {\n                    mThreadPool.submit(new ViewServerWorker(client));\n                } else {\n                    try {\n                        client.close();\n                    } catch (IOException e) {\n                        e.printStackTrace();\n                    }\n                }\n            } catch (Exception e) {\n                Log.w(LOG_TAG, \"Connection error: \", e);\n            }\n        }\n    }\n\n    private static boolean writeValue(Socket client, String value) {\n        boolean result;\n        BufferedWriter out = null;\n        try {\n            OutputStream clientStream = client.getOutputStream();\n            out = new BufferedWriter(new OutputStreamWriter(clientStream), 8 * 1024);\n            out.write(value);\n            out.write(\"\\n\");\n            out.flush();\n            result = true;\n        } catch (Exception e) {\n            result = false;\n        } finally {\n            if (out != null) {\n                try {\n                    out.close();\n                } catch (IOException e) {\n                    result = false;\n                }\n            }\n        }\n        return result;\n    }\n\n    private class ViewServerWorker implements Runnable {\n        private Socket mClient;\n\n        public ViewServerWorker(Socket client) {\n            mClient = client;\n        }\n\n        public void run() {\n            BufferedReader in = null;\n            try {\n                in = new BufferedReader(new InputStreamReader(mClient.getInputStream()), 1024);\n                final String request = in.readLine();\n\n                // Process client request and send response\n                // ... (omitted for brevity)\n\n            } catch(IOException e) {\n                Log.w(LOG_TAG, \"Connection error: \", e);\n            } finally {\n                if (in != null) {\n                    try {\n                        in.close();\n                    } catch (IOException e) {\n                        e.printStackTrace();\n                    }\n                }\n                if (mClient != null) {\n                    try {\n                        mClient.close();\n                    } catch (IOException e) {\n                        e.printStackTrace();\n                    }\n                }\n            }\n        }\n    }\n}",
  "FSMID_for_test": 0,
  "Code_level": "Class-level"
}